"use strict";
import UIComponent from "../../../../base/UIComponent";
import classNames from "classnames";
import { unique } from "../../../../helpers/core/generators";

const defaultClassNames = "mpageui-SvgIcon";
const viewBox = "0 0 48 48";

/**
 generates the title in VDom for the svg element of the icon.
 * @param {Function} el - A function for creating virtual elements.
 * @param {id} id - unique id generated for the icon
 * @param {string} title - The title text for renderTitleTag.
 * @returns {Vdom} vDom - title of the control
 */
const renderTitleTag = (el, id, title) => el("title", { id }, title);

/**
 * The SvgIcon class will render an svg icon with the specified path.
 * @class SvgIcon
 */
export default class SvgIcon extends UIComponent {
    /**
     * Returns the initial set of props for the SvgIcon class.
     * @returns {object} Initial props.
     */
    initialProps() {
        const identifyingClass = this._name ? ` mpageui-SvgIcon-${this._name}` : "";
        return {
            classNames: "",
            defaultClassNames: `${defaultClassNames}${identifyingClass}`,
            path: [],
            label: ""
        };
    }

    /**
     * Used for identifying the icon after minification
     * @returns {string} identifier
     * @abstract
     */
    get _name() {
        return "";
    }

    /**
     * Returns the function that generates the VDom for the svg element of the icon.
     * @returns {Function} The function that generates the VDom for the svg icon.
     */
    getSvg() {
        const props = this.getProps();
        const uniqueId = unique(this._name);
        return (el) => el("svg", {
            viewBox,
            draggable: "false",
            focusable: "false",
            class: classNames({
                [ props.defaultClassNames ]: true,
                [ props.classNames ]: (props.classNames !== "")
            }),
            "aria-labelledby": uniqueId
        }, [ renderTitleTag(el, uniqueId, this.getProp("label")), this.getRenderedBody(el) ]);
    }

    /**
     * Create VDom for svg body and returns it
     * @param {Function} el - VDOm creator
     * @returns {VDom} Body vdom
     */
    getRenderedBody(el) {
        return this.getProp("path").map((path) => el("path", {
            d: path
        }, []));
    }

    /**
     * @inheritDoc
     */
    view(el, props) {
        return this.getSvg()(el, {
            viewBox,
            draggable: "false",
            focusable: "false",
            class: classNames({
                [ props.defaultClassNames ]: true,
                [ props.classNames ]: (props.classNames !== "")
            }),
            "aria-labelledby": unique(this._name)
        }, this.getProp("label"));
    }
}
